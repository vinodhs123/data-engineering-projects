{% set container_value = var('container') %}
{% set storage_account_value = var('storage_account') %}
{% set bootstrap_storage_location = var('bootstrap_storage_location') %}
{% set incremental_storage_location = var('incremental_storage_location') %}

{{ load_data_with_metadata(
    historical_source="abfss://" ~ container_value ~ "@" ~ storage_account_value ~ ".dfs.core.windows.net/" ~ bootstrap_storage_location ~"/afko.parquet",
    incremental_source="abfss://" ~ container_value ~ "@" ~ storage_account_value ~ ".dfs.core.windows.net/" ~ incremental_storage_location ~"/afko/",
    all_columns=[
		{"name": "mandt", "data_type": "STRING"},
		{"name": "aufnr", "data_type": "STRING"},
		{"name": "gltrp", "data_type": "STRING"},
		{"name": "gstrp", "data_type": "STRING"},
		{"name": "ftrms", "data_type": "STRING"},
		{"name": "gltrs", "data_type": "STRING"},
		{"name": "gstrs", "data_type": "STRING"},
		{"name": "gstri", "data_type": "STRING"},
		{"name": "getri", "data_type": "STRING"},
		{"name": "gltri", "data_type": "STRING"},
		{"name": "ftrmi", "data_type": "STRING"},
		{"name": "ftrmp", "data_type": "STRING"},
		{"name": "rsnum", "data_type": "STRING"},
		{"name": "gasmg", "data_type": "DECIMAL(13,3)"},
		{"name": "gamng", "data_type": "DECIMAL(13,3)"},
		{"name": "gmein", "data_type": "STRING"},
		{"name": "plnbez", "data_type": "STRING"},
		{"name": "plnty", "data_type": "STRING"},
		{"name": "plnnr", "data_type": "STRING"},
		{"name": "plnaw", "data_type": "STRING"},
		{"name": "plnal", "data_type": "STRING"},
		{"name": "pverw", "data_type": "STRING"},
		{"name": "plauf", "data_type": "STRING"},
		{"name": "plsvb", "data_type": "DECIMAL(13,3)"},
		{"name": "plnme", "data_type": "STRING"},
		{"name": "plsvn", "data_type": "DECIMAL(13,3)"},
		{"name": "pdatv", "data_type": "STRING"},
		{"name": "paenr", "data_type": "STRING"},
		{"name": "plgrp", "data_type": "STRING"},
		{"name": "lodiv", "data_type": "DECIMAL(13,3)"},
		{"name": "stlty", "data_type": "STRING"},
		{"name": "stlbez", "data_type": "STRING"},
		{"name": "stlst", "data_type": "STRING"},
		{"name": "stlnr", "data_type": "STRING"},
		{"name": "sdatv", "data_type": "STRING"},
		{"name": "sbmng", "data_type": "DECIMAL(13,3)"},
		{"name": "sbmeh", "data_type": "STRING"},
		{"name": "saenr", "data_type": "STRING"},
		{"name": "stlal", "data_type": "STRING"},
		{"name": "stlan", "data_type": "STRING"},
		{"name": "slsvn", "data_type": "DECIMAL(13,3)"},
		{"name": "slsbs", "data_type": "DECIMAL(13,3)"},
		{"name": "aufld", "data_type": "STRING"},
		{"name": "dispo", "data_type": "STRING"},
		{"name": "aufpl", "data_type": "STRING"},
		{"name": "fevor", "data_type": "STRING"},
		{"name": "fhori", "data_type": "STRING"},
		{"name": "terkz", "data_type": "STRING"},
		{"name": "redkz", "data_type": "STRING"},
		{"name": "aprio", "data_type": "STRING"},
		{"name": "ntzue", "data_type": "STRING"},
		{"name": "vorue", "data_type": "STRING"},
		{"name": "profid", "data_type": "STRING"},
		{"name": "vorgz", "data_type": "STRING"},
		{"name": "sichz", "data_type": "STRING"},
		{"name": "freiz", "data_type": "STRING"},
		{"name": "upter", "data_type": "STRING"},
		{"name": "bedid", "data_type": "STRING"},
		{"name": "pronr", "data_type": "STRING"},
		{"name": "zaehl", "data_type": "STRING"},
		{"name": "mzaehl", "data_type": "STRING"},
		{"name": "zkriz", "data_type": "STRING"},
		{"name": "prueflos", "data_type": "STRING"},
		{"name": "klvarp", "data_type": "STRING"},
		{"name": "klvari", "data_type": "STRING"},
		{"name": "rgekz", "data_type": "STRING"},
		{"name": "plart", "data_type": "STRING"},
		{"name": "flg_aob", "data_type": "STRING"},
		{"name": "flg_arbei", "data_type": "STRING"},
		{"name": "gltpp", "data_type": "STRING"},
		{"name": "gstpp", "data_type": "STRING"},
		{"name": "gltps", "data_type": "STRING"},
		{"name": "gstps", "data_type": "STRING"},
		{"name": "ftrps", "data_type": "STRING"},
		{"name": "rdkzp", "data_type": "STRING"},
		{"name": "trkzp", "data_type": "STRING"},
		{"name": "rueck", "data_type": "STRING"},
		{"name": "rmzhl", "data_type": "STRING"},
		{"name": "igmng", "data_type": "DECIMAL(13,3)"},
		{"name": "ratid", "data_type": "STRING"},
		{"name": "groid", "data_type": "STRING"},
		{"name": "cuobj", "data_type": "STRING"},
		{"name": "gluzs", "data_type": "STRING"},
		{"name": "gsuzs", "data_type": "STRING"},
		{"name": "revlv", "data_type": "STRING"},
		{"name": "rshty", "data_type": "STRING"},
		{"name": "rshid", "data_type": "STRING"},
		{"name": "rsnty", "data_type": "STRING"},
		{"name": "rsnid", "data_type": "STRING"},
		{"name": "nauterm", "data_type": "STRING"},
		{"name": "naucost", "data_type": "STRING"},
		{"name": "stufe", "data_type": "DECIMAL(13,3)"},
		{"name": "wegxx", "data_type": "DECIMAL(13,3)"},
		{"name": "vwegx", "data_type": "DECIMAL(13,3)"},
		{"name": "arsnr", "data_type": "STRING"},
		{"name": "arsps", "data_type": "STRING"},
		{"name": "maufnr", "data_type": "STRING"},
		{"name": "lknot", "data_type": "STRING"},
		{"name": "rknot", "data_type": "STRING"},
		{"name": "prodnet", "data_type": "STRING"},
		{"name": "iasmg", "data_type": "DECIMAL(13,3)"},
		{"name": "abarb", "data_type": "STRING"},
		{"name": "aufnt", "data_type": "STRING"},
		{"name": "aufpt", "data_type": "STRING"},
		{"name": "aplzt", "data_type": "STRING"},
		{"name": "no_disp", "data_type": "STRING"},
		{"name": "csplit", "data_type": "STRING"},
		{"name": "aennr", "data_type": "STRING"},
		{"name": "cy_seqnr", "data_type": "STRING"},
		{"name": "breaks", "data_type": "STRING"},
		{"name": "vorgz_trm", "data_type": "DECIMAL(13,3)"},
		{"name": "sichz_trm", "data_type": "DECIMAL(13,3)"},
		{"name": "trmdt", "data_type": "STRING"},
		{"name": "gluzp", "data_type": "STRING"},
		{"name": "gsuzp", "data_type": "STRING"},
		{"name": "gsuzi", "data_type": "STRING"},
		{"name": "geuzi", "data_type": "STRING"},
		{"name": "glupp", "data_type": "STRING"},
		{"name": "gsupp", "data_type": "STRING"},
		{"name": "glups", "data_type": "STRING"},
		{"name": "gsups", "data_type": "STRING"},
		{"name": "chsch", "data_type": "STRING"},
		{"name": "kapt_vorgz", "data_type": "STRING"},
		{"name": "kapt_sichz", "data_type": "STRING"},
		{"name": "lead_aufnr", "data_type": "STRING"},
		{"name": "pnetstartd", "data_type": "STRING"},
		{"name": "pnetstartt", "data_type": "STRING"},
		{"name": "pnetendd", "data_type": "STRING"},
		{"name": "pnetendt", "data_type": "STRING"},
		{"name": "kbed", "data_type": "STRING"},
		{"name": "kkalkr", "data_type": "STRING"},
		{"name": "sfcpf", "data_type": "STRING"},
		{"name": "rmnga", "data_type": "DECIMAL(13,3)"},
		{"name": "gsbtr", "data_type": "STRING"},
		{"name": "vfmng", "data_type": "DECIMAL(13,3)"},
		{"name": "nopcost", "data_type": "STRING"},
		{"name": "netzkont", "data_type": "STRING"},
		{"name": "atrkz", "data_type": "STRING"},
		{"name": "objtype", "data_type": "STRING"},
		{"name": "ch_proc", "data_type": "STRING"},
		{"name": "kapversa", "data_type": "STRING"},
		{"name": "colordproc", "data_type": "STRING"},
		{"name": "kzerb", "data_type": "STRING"},
		{"name": "conf_key", "data_type": "STRING"},
		{"name": "st_arbid", "data_type": "STRING"},
		{"name": "vsnmr_v", "data_type": "STRING"},
		{"name": "terhw", "data_type": "STRING"},
		{"name": "splstat", "data_type": "STRING"},
		{"name": "costupd", "data_type": "STRING"},
		{"name": "max_gamng", "data_type": "DECIMAL(13,3)"},
		{"name": "mes_routingid", "data_type": "STRING"},
		{"name": "adpsp", "data_type": "STRING"},
		{"name": "rmanr", "data_type": "STRING"},
		{"name": "posnr_rma", "data_type": "STRING"},
		{"name": "posnv_rma", "data_type": "STRING"},
		{"name": "cfb_maxlz", "data_type": "DECIMAL(13,3)"},
		{"name": "cfb_lzeih", "data_type": "STRING"},
		{"name": "cfb_adtdays", "data_type": "DECIMAL(13,3)"},
		{"name": "cfb_datofm", "data_type": "STRING"},
		{"name": "cfb_bbdpi", "data_type": "STRING"},
		{"name": "oihantyp", "data_type": "STRING"},
		{"name": "fsh_mprod_ord", "data_type": "STRING"},
		{"name": "flg_bundle", "data_type": "STRING"},
		{"name": "mill_ratio", "data_type": "INT"},
		{"name": "bmeins", "data_type": "STRING"},
		{"name": "bmenge", "data_type": "DECIMAL(13,3)"},
		{"name": "mill_oc_zuskz", "data_type": "STRING"},
		{"name": "tas_rp_change_date", "data_type": "TIMESTAMP"},
		{"name": "tas_rp_opcode", "data_type": "INT"}
    ],
    composite_keys=["mandt","aufnr"],
    transformation_column="tas_rp_opcode",
    transformation_map={"D": 0, "I": 1, "U": 2}
) }}

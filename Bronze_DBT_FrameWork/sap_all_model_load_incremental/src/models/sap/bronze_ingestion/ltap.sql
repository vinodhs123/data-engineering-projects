{% set container_value = var('container') %}
{% set storage_account_value = var('storage_account') %}
{% set bootstrap_storage_location = var('bootstrap_storage_location') %}
{% set incremental_storage_location = var('incremental_storage_location') %}

{{ load_data_with_metadata(
    historical_source="abfss://" ~ container_value ~ "@" ~ storage_account_value ~ ".dfs.core.windows.net/" ~ bootstrap_storage_location ~"/ltap.parquet",
    incremental_source="abfss://" ~ container_value ~ "@" ~ storage_account_value ~ ".dfs.core.windows.net/" ~ incremental_storage_location ~"/ltap/",
    all_columns=[
		{"name": "mandt", "data_type": "STRING"},
		{"name": "lgnum", "data_type": "STRING"},
		{"name": "tanum", "data_type": "STRING"},
		{"name": "tapos", "data_type": "STRING"},
		{"name": "tbpos", "data_type": "STRING"},
		{"name": "posnr", "data_type": "STRING"},
		{"name": "matnr", "data_type": "STRING"},
		{"name": "werks", "data_type": "STRING"},
		{"name": "charg", "data_type": "STRING"},
		{"name": "bestq", "data_type": "STRING"},
		{"name": "sobkz", "data_type": "STRING"},
		{"name": "sonum", "data_type": "STRING"},
		{"name": "stoff", "data_type": "STRING"},
		{"name": "meins", "data_type": "STRING"},
		{"name": "altme", "data_type": "STRING"},
		{"name": "umrez", "data_type": "DECIMAL(13,3)"},
		{"name": "umren", "data_type": "DECIMAL(13,3)"},
		{"name": "letyp", "data_type": "STRING"},
		{"name": "kzfeh", "data_type": "STRING"},
		{"name": "lanum", "data_type": "STRING"},
		{"name": "kzqui", "data_type": "STRING"},
		{"name": "kznko", "data_type": "STRING"},
		{"name": "nulko", "data_type": "STRING"},
		{"name": "kzinv", "data_type": "STRING"},
		{"name": "ivnum", "data_type": "STRING"},
		{"name": "pquit", "data_type": "STRING"},
		{"name": "qdatu", "data_type": "STRING"},
		{"name": "qzeit", "data_type": "STRING"},
		{"name": "qname", "data_type": "STRING"},
		{"name": "brgew", "data_type": "DECIMAL(13,3)"},
		{"name": "gewei", "data_type": "STRING"},
		{"name": "mbpos", "data_type": "STRING"},
		{"name": "wempf", "data_type": "STRING"},
		{"name": "ablad", "data_type": "STRING"},
		{"name": "wdatu", "data_type": "STRING"},
		{"name": "wenum", "data_type": "STRING"},
		{"name": "wepos", "data_type": "STRING"},
		{"name": "zeugn", "data_type": "STRING"},
		{"name": "ldest", "data_type": "STRING"},
		{"name": "vorga", "data_type": "STRING"},
		{"name": "vltyp", "data_type": "STRING"},
		{"name": "vlber", "data_type": "STRING"},
		{"name": "vlpla", "data_type": "STRING"},
		{"name": "vkdyn", "data_type": "STRING"},
		{"name": "vppos", "data_type": "STRING"},
		{"name": "vanzl", "data_type": "DECIMAL(13,3)"},
		{"name": "vanbr", "data_type": "STRING"},
		{"name": "vsolm", "data_type": "DECIMAL(13,3)"},
		{"name": "vistm", "data_type": "DECIMAL(13,3)"},
		{"name": "vdifm", "data_type": "DECIMAL(13,3)"},
		{"name": "vsola", "data_type": "DECIMAL(13,3)"},
		{"name": "vista", "data_type": "DECIMAL(13,3)"},
		{"name": "vdifa", "data_type": "DECIMAL(13,3)"},
		{"name": "vlqnr", "data_type": "STRING"},
		{"name": "vappc", "data_type": "STRING"},
		{"name": "nltyp", "data_type": "STRING"},
		{"name": "nlber", "data_type": "STRING"},
		{"name": "nlpla", "data_type": "STRING"},
		{"name": "nkdyn", "data_type": "STRING"},
		{"name": "nppos", "data_type": "STRING"},
		{"name": "nanzl", "data_type": "DECIMAL(13,3)"},
		{"name": "nanbr", "data_type": "STRING"},
		{"name": "nsolm", "data_type": "DECIMAL(13,3)"},
		{"name": "nistm", "data_type": "DECIMAL(13,3)"},
		{"name": "ndifm", "data_type": "DECIMAL(13,3)"},
		{"name": "nsola", "data_type": "DECIMAL(13,3)"},
		{"name": "nista", "data_type": "DECIMAL(13,3)"},
		{"name": "ndifa", "data_type": "DECIMAL(13,3)"},
		{"name": "nlqnr", "data_type": "STRING"},
		{"name": "nappc", "data_type": "STRING"},
		{"name": "rltyp", "data_type": "STRING"},
		{"name": "rlber", "data_type": "STRING"},
		{"name": "rlpla", "data_type": "STRING"},
		{"name": "rppos", "data_type": "STRING"},
		{"name": "rsolm", "data_type": "DECIMAL(13,3)"},
		{"name": "ristm", "data_type": "DECIMAL(13,3)"},
		{"name": "rdifm", "data_type": "DECIMAL(13,3)"},
		{"name": "rsola", "data_type": "DECIMAL(13,3)"},
		{"name": "rista", "data_type": "DECIMAL(13,3)"},
		{"name": "rdifa", "data_type": "DECIMAL(13,3)"},
		{"name": "rlqnr", "data_type": "STRING"},
		{"name": "rappc", "data_type": "STRING"},
		{"name": "dltyp", "data_type": "STRING"},
		{"name": "dlpla", "data_type": "STRING"},
		{"name": "dlqnr", "data_type": "STRING"},
		{"name": "dmeng", "data_type": "DECIMAL(13,3)"},
		{"name": "dmena", "data_type": "DECIMAL(13,3)"},
		{"name": "kzdif", "data_type": "STRING"},
		{"name": "maktx", "data_type": "STRING"},
		{"name": "druck", "data_type": "STRING"},
		{"name": "vlenr", "data_type": "STRING"},
		{"name": "nlenr", "data_type": "STRING"},
		{"name": "dlenr", "data_type": "STRING"},
		{"name": "vlest", "data_type": "STRING"},
		{"name": "nlest", "data_type": "STRING"},
		{"name": "lelas", "data_type": "STRING"},
		{"name": "homve", "data_type": "STRING"},
		{"name": "posty", "data_type": "STRING"},
		{"name": "orpos", "data_type": "STRING"},
		{"name": "vsumm", "data_type": "STRING"},
		{"name": "vblch", "data_type": "STRING"},
		{"name": "nsumm", "data_type": "STRING"},
		{"name": "nblch", "data_type": "STRING"},
		{"name": "rspos", "data_type": "STRING"},
		{"name": "vfdat", "data_type": "STRING"},
		{"name": "vkapv", "data_type": "DECIMAL(13,3)"},
		{"name": "vkapa", "data_type": "STRING"},
		{"name": "nkapa", "data_type": "STRING"},
		{"name": "rkapa", "data_type": "STRING"},
		{"name": "kzsub", "data_type": "STRING"},
		{"name": "qplos", "data_type": "STRING"},
		{"name": "qploa", "data_type": "STRING"},
		{"name": "kzsti", "data_type": "STRING"},
		{"name": "rsart", "data_type": "STRING"},
		{"name": "kzech", "data_type": "STRING"},
		{"name": "kober", "data_type": "STRING"},
		{"name": "lgort", "data_type": "STRING"},
		{"name": "solpo", "data_type": "DECIMAL(13,3)"},
		{"name": "zeiei", "data_type": "STRING"},
		{"name": "l2skr", "data_type": "STRING"},
		{"name": "volum", "data_type": "DECIMAL(13,3)"},
		{"name": "voleh", "data_type": "STRING"},
		{"name": "kzbef", "data_type": "STRING"},
		{"name": "imrel", "data_type": "STRING"},
		{"name": "nwirm", "data_type": "DECIMAL(13,3)"},
		{"name": "wirme", "data_type": "STRING"},
		{"name": "nplei", "data_type": "STRING"},
		{"name": "kbnkz", "data_type": "STRING"},
		{"name": "stoan", "data_type": "STRING"},
		{"name": "kgvnq", "data_type": "STRING"},
		{"name": "pvqui", "data_type": "STRING"},
		{"name": "edatu", "data_type": "STRING"},
		{"name": "ezeit", "data_type": "STRING"},
		{"name": "ename", "data_type": "STRING"},
		{"name": "kzfme", "data_type": "STRING"},
		{"name": "qusub", "data_type": "STRING"},
		{"name": "fhuta", "data_type": "STRING"},
		{"name": "vnest", "data_type": "STRING"},
		{"name": "vhilm", "data_type": "STRING"},
		{"name": "vdumm", "data_type": "STRING"},
		{"name": "ndumm", "data_type": "STRING"},
		{"name": "vseri", "data_type": "STRING"},
		{"name": "hupik", "data_type": "STRING"},
		{"name": "nxidv", "data_type": "STRING"},
		{"name": "nolis", "data_type": "STRING"},
		{"name": "npipo", "data_type": "STRING"},
		{"name": "pipar", "data_type": "STRING"},
		{"name": "pckpf", "data_type": "STRING"},
		{"name": "kztrm", "data_type": "STRING"},
		{"name": "passd", "data_type": "STRING"},
		{"name": "vbeln", "data_type": "STRING"},
		{"name": "kzxdk", "data_type": "STRING"},
		{"name": "kzvas", "data_type": "STRING"},
		{"name": "from_insp_guid", "data_type": "STRING"},
		{"name": "to_insp_guid", "data_type": "STRING"},
		{"name": "diff_insp_guid", "data_type": "STRING"},
		{"name": "return_insp_guid", "data_type": "STRING"},
		{"name": "dcnum", "data_type": "STRING"},
		{"name": "zrstg", "data_type": "STRING"},
		{"name": "tovas", "data_type": "STRING"},
		{"name": "sgt_scat", "data_type": "STRING"},
		{"name": "tas_rp_change_date", "data_type": "TIMESTAMP"},
		{"name": "tas_rp_opcode", "data_type": "INT"}

    ],
    composite_keys=["mandt","lgnum","tanum","tapos"],
    transformation_column="tas_rp_opcode",
    transformation_map={"D": 0, "I": 1, "U": 2}
) }}